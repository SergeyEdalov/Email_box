# Почтовый ящик
Простое приложение почтового ящика для отправки сообщений. Выполнен на 2-х микросервиса: Пользователи, Сообщения.

## Содержание
- [Стек проекта](#Стек-проекта)
- [Функциональность проекта](#Функциональность-проекта)
- [Описание микросервисов](#Описание-микросервисов)
  - [Users](#Users)
  - [Messages](#Messages)
- [База данных](#База-данных)
- [Docker](#Docker)
- [RabbitMQ](#RabbitMQ)
- [API Gateway(Ocelot)](#API-Gateway(Ocelot))
- [UnitTests](#UnitTests)
- [Запуск проекта](#Запуск-проекта)
- [P.S.](#P.S.)
---
### <a id="Стек-проекта">Стек проекта</a>
* [Asp Net Core](https://learn.microsoft.com/ru-ru/aspnet/core/introduction-to-aspnet-core?view=aspnetcore-8.0)
* [Entity Framework Core](https://docs.microsoft.com/ru-ru/ef/core/)
* Unit Tests
* [Docker](https://www.docker.com/)
* [RabbitMQ](https://www.rabbitmq.com/)
* [Api Gateway (Ocelot)](https://ocelot.readthedocs.io/en/latest/features/configuration.html)
---
### <a id="Функциональность-проекта">Функциональность проекта</a>
1. Сервис User
    - Аутентификация и авторизация
    - Добавление пользователя
    - Получение списка пользователей
    - Удаление пользователя
    - Получение id пользователя
2. Сервис Message
    - Отправка сообщений
    - Получение сообщений

---
### <a id="Описание-микросервисов">Описание микросервисов</a>
Оба микросервиса используют swagger. В них также присутствует Autofac для иннверсии зависимостей. Данные проходят через Automapper.  

#### <a id="User">User</a>
> https://localhost:7205/swagger/index.html

Микросервис осуществляет контроль пользователей в системе.
 * Аутентификация и авторизация  
Микросервис выполняет функции аутентификации и управления пользователями. 
Аутентификация происходит с помощью RSA-шифрования. В ответ направляется JWT-токен, в котором содержится id пользователя и его роль. В дальнейшем токен направляется в микросервис Message для проверки авторизации.
 * Добавить администратора  
Метод проверяет есть ли пользователи в системе, если нет, добавляет администратора.
В качестве логина используется email, которые проверяется по шаблону. Пароль проходит проверку по длине и сложности. Для этого создана библиотека для проверки входящих данных.
 * Добавить пользователя  
 Метод проверяет есть ли пользователь с таким именем в системе. Если нет, добавляет пользователя.
 * Получить список пользователей  
 Метод выводит список всех пользователей в системе.
 * Удалить пользователя  
 Метод удаляет пользователей, кроме администартора.
 * Получить id пользователя  
 Метод возвращает id пользователя из JWT-токена. Токен проходит проверку на валидность.

#### <a id="Message">Message</a>
> https://localhost:7191/swagger/index.html  

Микросервис выполняет функцию мессенджера.
 * Получить сообщения  
 Метод возвращает все неполученные сообщения от других пользователей. При этом сообщения помечаются, как прочитанные.
 * Отправить сообщение  
 Метод отправляет сообщение другому пользователю.  

---

### <a id="База-данных">База данных</a>
В проекте используются 2 базы данных.

 * Для микросервиса User
 * Для микросервиса Message

Подход проектирования БД: Code first  
Тип хранения данных: PostgreSQL & Docker  
ORM: Entity Framework Core  

---
### <a id="Docker">Docker</a>
Для проекта подготовлен docker-file для запуска БД .

---
### <a id="RabbitMQ">RabbitMQ</a>
Раздел в разработке...

---
### <a id="API-Gateway(Ocelot)">API Gateway(Ocelot)</a>
> https://localhost:7052/swagger/index.html

В проекте реализован Ocelot API Gateway для переадресации методов. 

---
### <a id="UnitTests">UnitTests</a>
Проект SolutionTests содержит Unit-тесты на функционал микросервисов User и Message.

---
### <a id="Запуск-проекта">Запуск проекта</a>
Для запуска проекта необходимо запустить docker-file в корневой папке проекта. Затем в Visual Studio запустить непосредственно сами проекты.

---
### <a id="P.S.">P.S.</a>
Это мой первый проект, так что прошу привести максимально объективную критику.